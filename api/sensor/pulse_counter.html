
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Pulse Counter Sensor &#8212; esphomelib 1.9.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="canonical" href="https://esphomelib.com/api/sensor/pulse_counter.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rotary Encoder Sensor" href="rotary_encoder.html" />
    <link rel="prev" title="PMSX003 Particulate Matter Sensor" href="pmsx003.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../../_static/apple-touch-icon.png" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo-full.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Pulse Counter Sensor</a><ul>
<li><a class="reference internal" href="#example-usage">Example Usage</a></li>
<li><a class="reference internal" href="#api-reference">API Reference</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pulse-counter-sensor">
<h1>Pulse Counter Sensor<a class="headerlink" href="#pulse-counter-sensor" title="Permalink to this headline">¶</a></h1>
<div class="section" id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span class="c1">// Basic</span>
<span class="n">App</span><span class="p">.</span><span class="n">make_pulse_counter_sensor</span><span class="p">(</span><span class="s">&quot;Pulse Counter&quot;</span><span class="p">,</span> <span class="mi">13</span><span class="p">);</span>
<span class="c1">// Unit conversion</span>
<span class="k">auto</span> <span class="n">pcnt_1</span> <span class="o">=</span> <span class="n">App</span><span class="p">.</span><span class="n">make_pulse_counter_sensor</span><span class="p">(</span><span class="s">&quot;Pulse Counter 2&quot;</span><span class="p">,</span> <span class="mi">13</span><span class="p">);</span>
<span class="n">pcnt_1</span><span class="p">.</span><span class="n">pcnt</span><span class="o">-&gt;</span><span class="n">set_unit_of_measurement</span><span class="p">(</span><span class="s">&quot;kW&quot;</span><span class="p">);</span>
<span class="n">pcnt_1</span><span class="p">.</span><span class="n">pcnt</span><span class="o">-&gt;</span><span class="n">clear_filters</span><span class="p">();</span>
<span class="n">pcnt_1</span><span class="p">.</span><span class="n">pcnt</span><span class="o">-&gt;</span><span class="n">add_multiply_filter</span><span class="p">(</span><span class="mf">0.06f</span><span class="p">);</span> <span class="c1">// convert from Wh pulse to kW</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../core/application.html#_CPPv3N11Application25make_pulse_counter_sensorERKNSt6stringERK12GPIOInputPin8uint32_t" title="Application::make_pulse_counter_sensor"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Application::make_pulse_counter_sensor()</span></code></a>.</p>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponentE">
<span id="_CPPv2N6sensor27PulseCounterSensorComponentE"></span><span id="sensor::PulseCounterSensorComponent"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component"></span><em class="property">class </em><code class="descname">PulseCounterSensorComponent</code> : <em class="property">public</em> sensor::<a class="reference internal" href="index.html#_CPPv3N6sensor22PollingSensorComponentE" title="sensor::PollingSensorComponent">PollingSensorComponent</a>, <em class="property">public</em> sensor::PulseCounterBase<a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponentE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pulse Counter - This is the sensor component for the ESP32 integrated pulse counter peripheral. </p>
<p>It offers 8 pulse counter units that can be setup in several ways to count pulses on a pin. Also allows for some simple filtering of short pulses using set_filter(), any pulse shorter than the value provided to that function will be discarded. The time is given in APB clock cycles, which usually amount to 12.5 ns per clock. Defaults to the max possible (about 13 ms). See <a class="reference external" href="http://esp-idf.readthedocs.io/en/latest/api-reference/peripherals/pcnt.html">http://esp-idf.readthedocs.io/en/latest/api-reference/peripherals/pcnt.html</a> for more information.</p>
<p>The pulse counter defaults to reporting a value of the measurement unit “pulses/min”. To modify this behavior, use filters in MQTTSensor. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Functions</p>
<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent27PulseCounterSensorComponentERKNSt6stringEP7GPIOPin8uint32_t">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent27PulseCounterSensorComponentERKNSt6stringEP7GPIOPin8uint32_t"></span><span id="sensor::PulseCounterSensorComponent::PulseCounterSensorComponent__ssCR.GPIOPinP.uint32_t"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1a8580d42885607ea986680c1f811ab5a6"></span><code class="descname">PulseCounterSensorComponent</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>name</em>, <a class="reference internal" href="../core/helpers.html#_CPPv37GPIOPin" title="GPIOPin">GPIOPin</a> *<em>pin</em>, uint32_t <em>update_interval</em> = 15000<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent27PulseCounterSensorComponentERKNSt6stringEP7GPIOPin8uint32_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct the Pulse Counter instance with the provided pin and update interval. </p>
<p>The pulse counter unit will automatically be set and the pulse counter is set up to increment the counter on rising edges by default.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal notranslate"><span class="pre">pin</span></code>: The pin. </li>
<li><code class="docutils literal notranslate"><span class="pre">update_interval</span></code>: The update interval in ms. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent13set_edge_modeE21PulseCounterCountMode21PulseCounterCountMode">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent13set_edge_modeE21PulseCounterCountMode21PulseCounterCountMode"></span><span id="sensor::PulseCounterSensorComponent::set_edge_mode__PulseCounterCountMode.PulseCounterCountMode"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1a13c22f96103358472615bd95d463fef9"></span>void <code class="descname">set_edge_mode</code><span class="sig-paren">(</span>PulseCounterCountMode <em>rising_edge_mode</em>, PulseCounterCountMode <em>falling_edge_mode</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent13set_edge_modeE21PulseCounterCountMode21PulseCounterCountMode" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the PulseCounterCountMode for the rising and falling edges. can be disable, increment and decrement. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent13set_filter_usE8uint32_t">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent13set_filter_usE8uint32_t"></span><span id="sensor::PulseCounterSensorComponent::set_filter_us__uint32_t"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1abfb7bb6650599877f19dd4ef4c65ef44"></span>void <code class="descname">set_filter_us</code><span class="sig-paren">(</span>uint32_t <em>filter_us</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent13set_filter_usE8uint32_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent19unit_of_measurementEv">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent19unit_of_measurementEv"></span><span id="sensor::PulseCounterSensorComponent::unit_of_measurement"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1adc2a4d268c957ead87daa36ad925a590"></span>std::string <code class="descname">unit_of_measurement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent19unit_of_measurementEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Unit of measurement is “pulses/min”. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent4iconEv">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent4iconEv"></span><span id="sensor::PulseCounterSensorComponent::icon"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1adf1704f6db855cffb0fa56f7126f3159"></span>std::string <code class="descname">icon</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent4iconEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Override this to set the Home Assistant icon for this sensor. </p>
<p>Return “” to disable this feature.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The icon of this sensor, for example “mdi:battery”. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent17accuracy_decimalsEv">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent17accuracy_decimalsEv"></span><span id="sensor::PulseCounterSensorComponent::accuracy_decimals"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1a8a286ceec9fb8e4e4b79dec45896e635"></span>int8_t <code class="descname">accuracy_decimals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent17accuracy_decimalsEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the accuracy in decimals for this sensor. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent5setupEv">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent5setupEv"></span><span id="sensor::PulseCounterSensorComponent::setup"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1abed279c2845da79ae829ce9f6a643619"></span>void <code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent5setupEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Where the component’s initialization should happen. </p>
<p>Analogous to Arduino’s <a class="reference internal" href="#classsensor_1_1_pulse_counter_sensor_component_1abed279c2845da79ae829ce9f6a643619"><span class="std std-ref">setup()</span></a>. This method is guaranteed to only be called once. Defaults to doing nothing. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent6updateEv">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent6updateEv"></span><span id="sensor::PulseCounterSensorComponent::update"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1a8093293209acdd4fce318bbe09a44f86"></span>void <code class="descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent6updateEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="function">
<dt id="_CPPv3NK6sensor27PulseCounterSensorComponent18get_setup_priorityEv">
<span id="_CPPv2NK6sensor27PulseCounterSensorComponent18get_setup_priorityEv"></span><span id="sensor::PulseCounterSensorComponent::get_setup_priorityC"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1aee6566f02d07868b2f8b463ea6bb64e3"></span>float <code class="descname">get_setup_priority</code><span class="sig-paren">(</span><span class="sig-paren">)</span> <em class="property">const</em><a class="headerlink" href="#_CPPv3NK6sensor27PulseCounterSensorComponent18get_setup_priorityEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>priority of <a class="reference internal" href="#classsensor_1_1_pulse_counter_sensor_component_1abed279c2845da79ae829ce9f6a643619"><span class="std std-ref">setup()</span></a>. </p>
<p>higher -&gt; executed earlier</p>
<p>Defaults to 0.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The setup priority of this component </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv3N6sensor27PulseCounterSensorComponent11dump_configEv">
<span id="_CPPv2N6sensor27PulseCounterSensorComponent11dump_configEv"></span><span id="sensor::PulseCounterSensorComponent::dump_config"></span><span class="target" id="classsensor_1_1_pulse_counter_sensor_component_1ace55c60fd742f457b06260f555e00af5"></span>void <code class="descname">dump_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv3N6sensor27PulseCounterSensorComponent11dump_configEv" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>