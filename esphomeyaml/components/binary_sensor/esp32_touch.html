
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ESP32 Touch Pad Binary Sensor &#8212; esphomelib 1.8.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Template Binary Sensor" href="template.html" />
    <link rel="prev" title="ESP32 Bluetooth Low Energy Device" href="esp32_ble_tracker.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../../../_static/apple-touch-icon.png" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/logo-full.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ESP32 Touch Pad Binary Sensor</a><ul>
<li><a class="reference internal" href="#configuration-variables">Configuration variables:</a></li>
<li><a class="reference internal" href="#touch-pad-pins">Touch Pad Pins</a></li>
<li><a class="reference internal" href="#finding-thresholds">Finding thresholds</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="esp32-touch-pad-binary-sensor">
<h1>ESP32 Touch Pad Binary Sensor<a class="headerlink" href="#esp32-touch-pad-binary-sensor" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">esp32_touch</span></code> binary sensor platform lets you use the touch peripheral of the
ESP32 to detect if a certain pin is being “touched”.</p>
<p>First, you need to setup the <a class="reference internal" href="../esp32_touch.html"><span class="doc">global touch hub</span></a>. Then
you can add individual touch pads as binary sensors. When a touch is detected on these pins, the binary
sensor will report an <code class="docutils literal notranslate"><span class="pre">ON</span></code> state. And, of course, if no touch is detected, the binary sensor will report
an <code class="docutils literal notranslate"><span class="pre">OFF</span></code> state.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../../_images/esp32_touch-ui.png"><img alt="../../../_images/esp32_touch-ui.png" src="../../../_images/esp32_touch-ui.png" style="width: 80.0%;" /></a>
</div>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span class="c1"># Example configuration entry</span>
<span class="n">esp32_touch</span><span class="p">:</span>

<span class="n">binary_sensor</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">platform</span><span class="p">:</span> <span class="n">esp32_touch</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;ESP32 Touch Pad GPIO27&quot;</span>
    <span class="n">pin</span><span class="p">:</span> <span class="n">GPIO27</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="mi">1000</span>
</pre></div>
</div>
<div class="section" id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>pin</strong> (<strong>Required</strong>, <a class="reference internal" href="../../guides/configuration-types.html#config-pin"><span class="std std-ref">Pin</span></a>): The pin to detect touch
events on.</li>
<li><strong>threshold</strong> (<strong>Required</strong>, int): The threshold to use to detect touch events. Smaller values mean
a higher probability that the pad is being touched.</li>
<li><strong>name</strong> (<strong>Required</strong>, string): The name of the binary sensor.</li>
<li><strong>id</strong> (<em>Optional</em>,
<a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Manually specify
the ID used for code generation.</li>
<li>All other options from <a class="reference internal" href="index.html#config-binary-sensor"><span class="std std-ref">Binary Sensor</span></a>
and <a class="reference internal" href="../mqtt.html#config-mqtt-component"><span class="std std-ref">MQTT Component</span></a>.</li>
</ul>
</div>
<div class="section" id="touch-pad-pins">
<h2>Touch Pad Pins<a class="headerlink" href="#touch-pad-pins" title="Permalink to this headline">¶</a></h2>
<p>8 pins on the ESP32 can be used to detect touches. These are (in the default “raw” pin names):</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">GPIO0</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO2</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO4</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO12</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO13</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO14</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO15</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO27</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO32</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">GPIO33</span></code></li>
</ul>
</div>
<div class="section" id="finding-thresholds">
<h2>Finding thresholds<a class="headerlink" href="#finding-thresholds" title="Permalink to this headline">¶</a></h2>
<p>For each touch pad you want to monitor, you need to find a threshold first. This threshold is
used to determine if a pad is being touched or not using the raw values from the sensor. Lower
raw values mean that it is more likely that a touch is happening. For example, values around
1000 to 1600 usually mean the pad is not being touched, and values in the range of 600 and less
mean the pad is probably being touched.</p>
<p>To find suitable threshold values, first configure the <a class="reference internal" href="../esp32_touch.html"><span class="doc">ESP32 touch hub</span></a>
to output measured values using the <code class="docutils literal notranslate"><span class="pre">setup_mode:</span></code> configuration option. Next, add some binary sensors
for the touch pads you want to observe. Also put some threshold in the configuration as seen below
to make the validator happy, we are going to find good thresholds in a moment anyway.</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span class="c1"># Example configuration entry for finding threshold values</span>
<span class="n">esp32_touch</span><span class="p">:</span>
  <span class="n">setup_mode</span><span class="p">:</span> <span class="kc">True</span>

<span class="n">binary_sensor</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">platform</span><span class="p">:</span> <span class="n">esp32_touch</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;ESP32 Touch Pad GPIO27&quot;</span>
    <span class="n">pin</span><span class="p">:</span> <span class="n">GPIO27</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="mi">1000</span>
</pre></div>
</div>
<p>Then upload the program and open the logs, you will see values like these. Try touching the pins
and you will (hopefully) see the value decreasing a bit. Play around with different amounts of
force you put on the touch pad until you find a good value that can differentiate between
touch/non-touch events.</p>
<div class="figure align-center">
<img alt="../../../_images/esp32_touch-finding_thresholds.png" src="../../../_images/esp32_touch-finding_thresholds.png" />
</div>
<p>Finally, put your threshold parameter in the configuration. Do not forget to disable the <code class="docutils literal notranslate"><span class="pre">setup_mode</span></code>
option again by setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Otherwise you will end up spamming the logs and slowing the device
down.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../esp32_touch.html"><span class="doc">ESP32 Touch Pad Hub</span></a></li>
<li><a class="reference internal" href="index.html"><span class="doc">Binary Sensor Component</span></a></li>
<li><a class="reference internal" href="../../../api/binary_sensor/esp32_touch.html"><span class="doc">API Reference</span></a></li>
<li><a class="reference external" href="https://esp-idf.readthedocs.io/en/latest/api-reference/peripherals/touch_pad.html">esp-idf Touch Sensor API</a></li>
<li><a class="reference external" href="https://github.com/OttoWinter/esphomedocs/blob/current/esphomeyaml/components/binary_sensor/esp32_touch.rst">Edit this page on GitHub</a></li>
</ul>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Otto Winter.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>