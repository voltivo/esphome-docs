
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="description" content="Getting started guide for contributing to the esphomelib project">
<meta itemprop="name" content="Contributing">
<meta itemprop="description" content="Getting started guide for contributing to the esphomelib project">
<meta itemprop="image" content="https://esphomelib.com/_images/github-circle.svg">
<meta name="twitter:title" content="Contributing">
<meta name="twitter:image:src" content="https://esphomelib.com/_images/github-circle.svg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Getting started guide for contributing to the esphomelib project">
<meta property="og:title" content="Contributing"/>
<meta property="og:image" content="https://esphomelib.com/_images/github-circle.svg"/>
<meta property="og:type" content="website"/>
<meta property="og:site_name" content="esphomelib"/>
<meta property="og:description" content="Getting started guide for contributing to the esphomelib project"/>
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="theme-color" content="#DFDFDF">

    <title>Contributing &#8212; esphomelib 1.9.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/disqus.js"></script>
    <link rel="canonical" href="https://esphomelib.com/esphomeyaml/guides/contributing.html" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Frequently Asked Questions" href="faq.html" />
    <link rel="prev" title="Configuration Types" href="configuration-types.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
    <link rel="apple-touch-icon" href="../../_static/apple-touch-icon.png" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo-full.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Contributing</a><ul>
<li><a class="reference internal" href="#contributing-to-esphomedocs">Contributing to esphomedocs</a></li>
<li><a class="reference internal" href="#contributing-to-esphomelib">Contributing to esphomelib</a></li>
<li><a class="reference internal" href="#contributing-to-esphomeyaml">Contributing to esphomeyaml</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¬∂</a></h1>
<p>Contributions to the esphomelib suite are very welcome! All the code for the projects
is hosted on GitHub and you can find the sources here:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/OttoWinter/esphomelib">esphomelib</a> (The C++ framework)</li>
<li><a class="reference external" href="https://github.com/OttoWinter/esphomeyaml">esphomeyaml</a> (The Python YAML to C++ transpiler)</li>
<li><a class="reference external" href="https://github.com/OttoWinter/esphomedocs">esphomedocs</a> (The documentation which you‚Äôre reading here)</li>
</ul>
<p>Just clone the repository locally, do the changes for your new feature/bug fix and submit
a pull request. I will try to take a look at your PR as soon as possible.</p>
<div class="section" id="contributing-to-esphomedocs">
<h2>Contributing to esphomedocs<a class="headerlink" href="#contributing-to-esphomedocs" title="Permalink to this headline">¬∂</a></h2>
<p>One of the areas of esphomelib that can always be improved is the documentation.
If you see an issue somewhere, or spelling mistakes or if you want to share your awesome
setup, please feel free to submit a pull request.</p>
<p>The esphomelib documentation is built using <a class="reference external" href="http://www.sphinx-doc.org/">sphinx</a> and uses
<a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> for all source files.</p>
<p>In my opinion, markdown would have been the much better choice in hindsight, but at the time
I was setting up the documentation good doxygen integration was key to me. Anyway, here‚Äôs a quick
RST primer:</p>
<ul>
<li><p class="first"><strong>Headers</strong>: You can write titles like this:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="n">My</span> <span class="n">Title</span>
<span class="o">========</span>
</pre></div>
</div>
<p>and section headers like this:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="n">My</span> <span class="n">Sub</span> <span class="n">Section</span>
<span class="o">--------------</span>
</pre></div>
</div>
<p>and sub-section headers like this:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="n">My</span> <span class="n">Sub</span><span class="o">-</span><span class="n">sub</span> <span class="n">section</span>
<span class="o">******************</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Links</strong>: To create a link to an external resource (for example <a class="reference external" href="https://www.google.com">https://www.google.com</a>), use
<code class="docutils literal notranslate"><span class="pre">\`Link</span> <span class="pre">text</span> <span class="pre">&lt;link_url&gt;\`__</span></code>. For example:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre>`Google.com &lt;https://www.google.com&gt;`__
</pre></div>
</div>
<p><a class="reference external" href="https://www.google.com">Google.com</a></p>
</li>
<li><p class="first"><strong>References</strong>: To reference another document, use the <code class="docutils literal notranslate"><span class="pre">:doc:</span></code> and <code class="docutils literal notranslate"><span class="pre">:ref:</span></code> roles (references
are set up globally and can be used between documents):</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre>.. _my-reference-label:

Section to cross-reference
^^^^^^^^^^^^^^^^^^^^^^^^^^

See :ref:`my-reference-label`, also see :doc:`/esphomeyaml/components/switch/gpio`.
:doc:`Using custom text &lt;/esphomeyaml/components/switch/gpio&gt;`.
</pre></div>
</div>
<p>See <a class="reference internal" href="../index.html#devices"><span class="std std-ref">Devices</span></a>, also see <a class="reference internal" href="../components/switch/gpio.html"><span class="doc">GPIO Switch</span></a>.
<a class="reference internal" href="../components/switch/gpio.html"><span class="doc">Using custom text</span></a>.</p>
</li>
<li><p class="first"><strong>Inline code</strong>: To have text appear <code class="docutils literal notranslate"><span class="pre">like</span> <span class="pre">this</span></code>, use double backticks:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre>To have text appear ``like this``, use double backticks.
</pre></div>
</div>
<p>To have text appear <code class="docutils literal notranslate"><span class="pre">like</span> <span class="pre">this</span></code>, use double backticks.</p>
</li>
<li><p class="first"><strong>Code blocks</strong>: To show a sample configuration file, use the <code class="docutils literal notranslate"><span class="pre">code</span></code> directive:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="o">..</span> <span class="n">code</span><span class="p">::</span> <span class="n">yaml</span>

    <span class="c1"># Sample configuration entry</span>
    <span class="n">switch</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">platform</span><span class="p">:</span> <span class="n">gpio</span>
        <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Relay #42&quot;</span>
        <span class="n">pin</span><span class="p">:</span> <span class="n">GPIO13</span>
</pre></div>
</div>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span class="c1"># Sample configuration entry</span>
<span class="n">switch</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">platform</span><span class="p">:</span> <span class="n">gpio</span>
    <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;Relay #42&quot;</span>
    <span class="n">pin</span><span class="p">:</span> <span class="n">GPIO13</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The YAML syntax highlighter is currently broken. Somehow sphinx thinks this should be
C++ code ü§Ø. If you know how to fix this, it would be very much appreciated üòâ</p>
</div>
</li>
<li><p class="first"><strong>Images</strong>: To show images, use the <code class="docutils literal notranslate"><span class="pre">figure</span></code> directive:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="o">..</span> <span class="n">figure</span><span class="p">::</span> <span class="n">images</span><span class="o">/</span><span class="n">dashboard</span><span class="o">.</span><span class="n">png</span>
    <span class="p">:</span><span class="n">align</span><span class="p">:</span> <span class="n">center</span>
    <span class="p">:</span><span class="n">width</span><span class="p">:</span> <span class="mf">40.0</span><span class="o">%</span>

    <span class="n">Optional</span> <span class="n">figure</span> <span class="n">caption</span><span class="o">.</span>
</pre></div>
</div>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/dashboard.png"><img alt="../../_images/dashboard.png" src="../../_images/dashboard.png" style="width: 40.0%;" /></a>
<p class="caption"><span class="caption-text">Optional figure caption.</span></p>
</div>
</li>
<li><p class="first"><strong>Notes and warnings</strong>: You can create simple notes and warnings using the <code class="docutils literal notranslate"><span class="pre">note</span></code> and <code class="docutils literal notranslate"><span class="pre">warning</span></code>
directives:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="o">..</span> <span class="n">note</span><span class="p">::</span>

     <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">note</span><span class="o">.</span>

<span class="o">..</span> <span class="n">warning</span><span class="p">::</span>

     <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">warning</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a note.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a warning.</p>
</div>
</li>
<li><p class="first"><strong>Italic and boldface font families</strong>: To <em>italicize</em> text, use one asterisk around the text. To put
<strong>a strong emphasis</strong> on a piece of text, put two asterisks around it.</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="o">*</span><span class="n">This</span> <span class="ow">is</span> <span class="n">italicized</span><span class="o">.*</span> <span class="p">(</span><span class="n">A</span> <span class="n">weird</span> <span class="n">word</span><span class="o">...</span><span class="p">)</span>
<span class="o">**</span><span class="n">This</span> <span class="ow">is</span> <span class="n">very</span> <span class="n">important</span><span class="o">.**</span>
</pre></div>
</div>
<p><em>This is italicized.</em> (A weird word‚Ä¶)
<strong>This is very important.</strong></p>
</li>
<li><p class="first"><strong>Ordered and unordered list</strong>: The syntax for lists in RST is more or less the same as in markdown:</p>
<div class="code rst highlight-default notranslate"><div class="highlight"><pre><span class="o">-</span> <span class="n">Unordered</span> <span class="n">Item</span>

  <span class="o">-</span> <span class="n">Unordered</span> <span class="n">Sub</span><span class="o">-</span><span class="n">Item</span>

<span class="o">-</span> <span class="n">Item</span> <span class="k">with</span> <span class="n">a</span> <span class="n">very</span> <span class="n">long</span> <span class="n">text</span> <span class="n">so</span> <span class="n">that</span> <span class="n">it</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">fully</span> <span class="n">fit</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">single</span> <span class="n">line</span> <span class="ow">and</span>
  <span class="n">must</span> <span class="n">be</span> <span class="n">split</span> <span class="n">up</span> <span class="n">into</span> <span class="n">multiple</span> <span class="n">lines</span><span class="o">.</span>

<span class="mf">1.</span> <span class="n">Ordered</span> <span class="n">Item</span> <span class="c1">#1</span>
<span class="mf">2.</span> <span class="n">Ordered</span> <span class="n">Item</span> <span class="c1">#2</span>
</pre></div>
</div>
<ul class="simple">
<li>Unordered Item<ul>
<li>Unordered Sub-Item</li>
</ul>
</li>
<li>Item with a very long text so that it does not fully fit in a single line and
must be split up into multiple lines.</li>
</ul>
<ol class="arabic simple">
<li>Ordered Item #1</li>
<li>Ordered Item #2</li>
</ol>
</li>
</ul>
<p>reStructured text can do a lot more than this, so if you‚Äôre looking for a more complete guide
please have a look at the <a class="reference external" href="http://www.sphinx-doc.org/en/master/usage/restructuredtext/basics.html">Sphinx reStructuredText Primer</a>.</p>
<p>To check your documentation changes locally, you first need install sphinx (<strong>with Python 3</strong>) and
<a class="reference external" href="http://www.stack.nl/~dimitri/doxygen/">doxygen</a>.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span class="c1"># in esphomedocs repo:</span>
<span class="n">pip3</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Alternatively, you can use the <a class="reference external" href="https://hub.docker.com/r/ottowinter/esphomedocs/">esphomedocs docker image</a>:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;$PWD/..&quot;</span><span class="p">:</span><span class="o">/</span><span class="n">data</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8000</span><span class="p">:</span><span class="mi">8000</span> <span class="o">-</span><span class="n">it</span> <span class="n">ottowinter</span><span class="o">/</span><span class="n">esphomedocs</span>
</pre></div>
</div>
<p class="last">And then go to <code class="docutils literal notranslate"><span class="pre">&lt;CONTAINER_IP&gt;:8000</span></code> in your browser.</p>
</div>
<p>Next, you will also need to clone the <a class="reference external" href="https://github.com/OttoWinter/esphomelib">esphomelib repository</a> into
the folder where <code class="docutils literal notranslate"><span class="pre">esphomedocs</span></code> sits like this:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre>‚îú‚îÄ‚îÄ esphomedocs/
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ api/
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ esphomeyaml/
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Doxygen
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ Makefile
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ index.rst
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ esphomelib/
    ‚îú‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ examples/
    ‚îú‚îÄ‚îÄ library.json
    ‚îú‚îÄ‚îÄ platformio.ini
    ‚îî‚îÄ‚îÄ ...
</pre></div>
</div>
<p>Then, use the provided Makefile to build the changes and start a simple web server:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span class="c1"># Update doxygen API docs</span>
<span class="n">make</span> <span class="n">doxyg</span>
<span class="c1"># Start web server on port 8000</span>
<span class="n">make</span> <span class="n">webserver</span>

<span class="c1"># Updates then happen via:</span>
<span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<p>Some notes about the docs:</p>
<ul class="simple">
<li>Use the english language (duh‚Ä¶)</li>
<li>An image tells a thousand words, please use them wherever possible. But also don‚Äôt forget to shrink them, for example
I often use <a class="reference external" href="https://tinypng.com/">https://tinypng.com/</a></li>
<li>Try to use examples as often as possible (also while it‚Äôs great to use highly accurate,
and domain-specific lingo, it should not interfere with new users understanding the content)</li>
<li>When adding new files, please also add them to the <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file in the directory you‚Äôre editing.</li>
<li>Fixes/improvements for the docs themselves should go to the <code class="docutils literal notranslate"><span class="pre">current</span></code> branch of the
esphomedocs repository. New features should be added against the <code class="docutils literal notranslate"><span class="pre">next</span></code> branch.</li>
</ul>
</div>
<div class="section" id="contributing-to-esphomelib">
<h2>Contributing to esphomelib<a class="headerlink" href="#contributing-to-esphomelib" title="Permalink to this headline">¬∂</a></h2>
<p>esphomelib is the engine behind all the esphomeyaml stuff. The framework is also designed
to be used on its own - i.e. without esphomeyaml. To contribute code to esphomelib to fix
a bug or add a new integration/feature, clone the repository, make your changes and create
a pull request.</p>
<p>At some point, I will create a dedicated guide for the exact setup used, but for now just
look around the code base a bit and see how other components are doing stuff.</p>
<p>To initialize the development environment, navigate to the repository and execute:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span class="c1"># View available IDEs:</span>
<span class="n">pio</span> <span class="n">init</span> <span class="o">--</span><span class="n">help</span>
<span class="c1"># Initialize for IDE</span>
<span class="n">pio</span> <span class="n">init</span> <span class="o">--</span><span class="n">ide</span> <span class="p">{</span><span class="n">YOUR_IDE</span><span class="p">}</span>
</pre></div>
</div>
<p>Standard for the esphomelib codebase:</p>
<ul class="simple">
<li>All features should at least have a bit of documentation using the doxygen documentation style
(see other source files for reference)</li>
<li>The code style is based on the <a class="reference external" href="https://google.github.io/styleguide/cppguide.html">Google C++ Style Guide</a> with
a few modifications:<ul>
<li>function, method and variable names are <code class="docutils literal notranslate"><span class="pre">lower_snake_case</span></code></li>
<li>class/struct/enum names should be <code class="docutils literal notranslate"><span class="pre">UpperCamelCase</span></code></li>
<li>constants should be <code class="docutils literal notranslate"><span class="pre">UPPER_SNAKE_CASE</span></code></li>
<li>fields should be <code class="docutils literal notranslate"><span class="pre">protected</span></code> and <code class="docutils literal notranslate"><span class="pre">lowe_snake_case_with_trailing_underscore_</span></code>.</li>
<li>It‚Äôs preferred to use long variable/function names over short and non-descriptive ones.</li>
</ul>
</li>
<li>Use two spaces, not tabs.</li>
<li>Using <code class="docutils literal notranslate"><span class="pre">#define</span></code> s is discouraged and should be replaced by constants.</li>
<li>Use <code class="docutils literal notranslate"><span class="pre">using</span> <span class="pre">type_t</span> <span class="pre">=</span> <span class="pre">int;</span></code> instead of <code class="docutils literal notranslate"><span class="pre">typedef</span> <span class="pre">int</span> <span class="pre">type_t;</span></code></li>
<li>Be careful with including large standard library headers, they can considerably
increase the code size.</li>
<li>All features should only be compiled if a user explicitly defined so using <code class="docutils literal notranslate"><span class="pre">-DUSE_&lt;FEATURE&gt;</span></code>
(see <code class="docutils literal notranslate"><span class="pre">esphomeyaml/defines.h</span></code>)</li>
<li>Header files <code class="docutils literal notranslate"><span class="pre">.h</span></code> should not include source code. All code should sit in C++ <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> files.
(except for templates)</li>
<li>Using explicit int sizes is like <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> is preferred over standard types like <code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">long</span></code>.</li>
<li>All new features should have at least one example usage in the examples directory.</li>
<li>New components should dump their configuration using <code class="docutils literal notranslate"><span class="pre">ESP_LOGCONFIG</span></code> at startup in <code class="docutils literal notranslate"><span class="pre">setup()</span></code></li>
<li>The number of external libraries should be kept to a minimum. If the component you‚Äôre developing has a simple
communication interface, please consider implementing the library natively in esphomelib.</li>
<li>Implementations for new devices should contain reference links for the datasheet and other sample
implementations.</li>
<li>Please test your changes :)</li>
</ul>
<p>For editing a local copy of esphomelib within the esphomeyaml ecosystem please see
<a class="reference internal" href="../components/esphomeyaml.html#esphomeyaml-esphomelib-version"><span class="std std-ref">esphomeyaml.esphomelib_version</span></a> option.</p>
</div>
<div class="section" id="contributing-to-esphomeyaml">
<h2>Contributing to esphomeyaml<a class="headerlink" href="#contributing-to-esphomeyaml" title="Permalink to this headline">¬∂</a></h2>
<p>esphomeyaml primarily does two things: It validates the configuration and creates C++ code.</p>
<p>The configuration validation should always be very strict with validating user input - it‚Äôs always
better to fail quickly if a configuration isn‚Äôt right than to have the user find out the issue after
a few hours of debugging.</p>
<p>Preferably, the configuration validation messages should explain the exact validation issue (and not ‚Äúinvalid name!‚Äù)
and try to suggest a possible fix.</p>
<p>The C++ code generation engine is 99% syntactic sugar and unfortunately not too well documented yet.
Have a look around other components and you will hopefully quickly get the gist of how to interact with
the code generation engine.</p>
<p>The python source code of your component will automatically be loaded if the user uses
it in the configuration. Specifically, it may contain these fields:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">CONFIG_SCHEMA</span></code>: for <em>components</em> like <code class="docutils literal notranslate"><span class="pre">dallas</span></code>. This is the configuration
schema that will be validated against the user configuration.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">PLATFORM_SCHEMA</span></code>: for <em>platforms</em> like <code class="docutils literal notranslate"><span class="pre">sensor.dallas</span></code>. This is the configuration schema that
will be validated against every <code class="docutils literal notranslate"><span class="pre">platform:</span></code> definition in the config of your platform name.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">to_code</span></code>: The ‚Äúworkhorse‚Äù of esphomeyaml. This will be called with the configuration of your component/platform
and you can add code to the global code index in here.</p>
<ul>
<li><p class="first">Call an <code class="docutils literal notranslate"><span class="pre">Application</span></code> method like this <code class="docutils literal notranslate"><span class="pre">App.make_dallas_component()</span></code></p>
</li>
<li><p class="first">Register a variable using <code class="docutils literal notranslate"><span class="pre">variable(&lt;TYPE&gt;,</span> <span class="pre">&lt;VAR_ID&gt;,</span> <span class="pre">rhs)</span></code>. This will generate an assignment expression
and add it to the global expression index. The return value is the left hand side variable which you can use
for further calls.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span class="o">&lt;</span><span class="n">TYPE</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">VAR_ID</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">rhs</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Register a variable of a pointer type using <code class="docutils literal notranslate"><span class="pre">Pvariable(&lt;TYPE&gt;,</span> <span class="pre">&lt;VAR_ID&gt;,</span> <span class="pre">rhs)</span></code>.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span class="o">&lt;</span><span class="n">TYPE</span><span class="o">&gt;</span> <span class="o">*&lt;</span><span class="n">VAR_ID</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">rhs</span><span class="o">&gt;</span><span class="p">;</span>

<span class="o">//</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">make_dallas_component</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15000</span><span class="p">)</span>
<span class="o">//</span> <span class="n">var</span> <span class="o">=</span> <span class="n">Pvariable</span><span class="p">(</span><span class="n">DallasComponent</span><span class="p">,</span> <span class="s2">&quot;dallas_id&quot;</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
<span class="o">//</span> <span class="n">add</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">hello_world</span><span class="p">())</span>
<span class="n">DallasComponent</span> <span class="o">*</span><span class="n">dallas_id</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">make_dallas_component</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15000</span><span class="p">)</span>
<span class="n">dallas_id</span><span class="o">-&gt;</span><span class="n">hello_world</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Expressions like <code class="docutils literal notranslate"><span class="pre">var.hello_world()</span></code> are not automatically added to the code and need to be added to the
global expression index using <code class="docutils literal notranslate"><span class="pre">add()</span></code>.</p>
</li>
<li><p class="first">Access variables using <code class="docutils literal notranslate"><span class="pre">get_variable()</span></code>. The variable will automatically know if it is a pointer and use
the correct operator. Additionally, you can pass a type as the second argument to <code class="docutils literal notranslate"><span class="pre">get_variable</span></code>. This will
cause esphomeyaml to use the first variable of that type.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span class="n">hub</span> <span class="o">=</span> <span class="n">get_variable</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONF_DALLAS_ID</span><span class="p">),</span> <span class="n">DallasComponent</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Pass configuration arguments to mock function calls (like <code class="docutils literal notranslate"><span class="pre">App.make_dallas_component</span></code>) using normal
python :)</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span class="n">rhs</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">make_dallas_component</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="n">CONF_PIN</span><span class="p">],</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CONF_UPDATE_INTERVAL</span><span class="p">))</span>
</pre></div>
</div>
<p>Note the <code class="docutils literal notranslate"><span class="pre">config.get()</span></code>: Trailing <code class="docutils literal notranslate"><span class="pre">None</span></code> values in function calls are stripped.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">BUILD_FLAGS</span></code>: Pass build flags that should be provided if your component is loaded.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span class="n">BUILD_FLAGS</span> <span class="o">=</span> <span class="s1">&#39;-DUSE_DALLAS_SENSOR&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">REQUIRED_BUILD_FLAGS</span></code>: Like <code class="docutils literal notranslate"><span class="pre">BUILD_FLAGS</span></code>, but also uses these build flags if the user has disabled build
flags in the <a class="reference internal" href="../components/esphomeyaml.html"><span class="doc">esphomeyaml section</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DEPENDENCIES</span></code>: Other components that are required to be in the user‚Äôs configuration if this platform/component
is loaded:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span class="n">DEPENDENCIES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i2c&#39;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ESP_PLATFORMS</span></code>: Provide a whitelist of platforms this integration works on. Default is work on all platforms.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span class="n">ESP_PLATFORMS</span> <span class="o">=</span> <span class="p">[</span><span class="n">ESP_PLATFORM_ESP32</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
<p>Run <code class="docutils literal notranslate"><span class="pre">pip2</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></code> to install a development version of esphomeyaml.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¬∂</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../index.html"><span class="doc">esphomeyaml index</span></a></li>
<li><a class="reference internal" href="faq.html"><span class="doc">Frequently Asked Questions</span></a></li>
<li><a class="reference external" href="https://github.com/OttoWinter/esphomedocs/blob/current/esphomeyaml/guides/contributing.rst">Edit this page on GitHub</a></li>
</ul>
<div data-disqus-identifier="esphomeyaml-guides-contributing" id="disqus_thread"></div></div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Otto Winter.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
    </div>

    

    
  </body>
</html>